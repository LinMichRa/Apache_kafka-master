<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Crear Orden</title>

    <!-- ‚úÖ Bootstrap para estilos bonitos -->
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet">

    <script>
        function saveToLocalStorage(order) {
            let orders = localStorage.getItem("orders");
            orders = orders ? JSON.parse(orders) : [];
            orders.push(order);
            localStorage.setItem("orders", JSON.stringify(orders));
        }

        async function enviarOrden(event) {
            event.preventDefault();

            const order = {
                product: document.getElementById("product").value,
                quantity: document.getElementById("quantity").value,
                price: document.getElementById("price").value,
                customer: document.getElementById("customer").value
            };

            const response = await fetch("/api/orders/create", {
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify(order)
            });

            if (response.ok) {
                saveToLocalStorage(order);
                alert("‚úÖ Orden enviada y guardada en localStorage");
                document.getElementById("orderForm").reset();
            } else {
                alert("‚ùå Error al enviar la orden");
            }
        }

        function verLocalStorage() {
            const data = JSON.parse(localStorage.getItem("orders") || "[]");
            console.log("üìå √ìrdenes en localStorage:", data);
            alert("Revisa la consola del navegador (F12)");
        }
    </script>
</head>
<body class="bg-light">

<div class="container mt-5">
    <div class="card shadow p-4" style="max-width: 600px; margin: auto;">
        <h2 class="text-center mb-4">Crear Orden</h2>

        <form id="orderForm" onsubmit="enviarOrden(event)">
            <div class="mb-3">
                <label class="form-label">Producto</label>
                <input type="text" id="product" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Cantidad</label>
                <input type="number" id="quantity" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Precio</label>
                <input type="number" id="price" step="0.01" class="form-control" required>
            </div>

            <div class="mb-3">
                <label class="form-label">Cliente</label>
                <input type="text" id="customer" class="form-control" required>
            </div>

            <button type="submit" class="btn btn-primary w-100">Enviar Orden</button>
        </form>

        <button
            class="btn btn-secondary w-100 mt-3"
            onclick="window.location.href='/ordenes/guardadas'">
            Ver √≥rdenes guardadas
        </button>

    </div>
</div>

<!-- ‚úÖ Script de Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
